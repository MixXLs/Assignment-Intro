<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>จัดการคำร้อง (เจ้าหน้าที่)</title>
  <link rel="stylesheet" href="../css/style.css" />
  <script defer src="../JavaScript/script.js"></script>
</head>

<body class="req-surface">
  <!-- Topbar -->
  <div class="topbar">
    <div class="seal">
      <a href="../index.html"><img src="../images/kmutnb_logo.png" alt="KMUTNB Logo" /></a>
    </div>
    <div class="kmut-text">
      KING MONGKUT'S UNIVERSITY OF TECHNOLOGY NORTH BANGKOK
      <small>มหาวิทยาลัยเทคโนโลยีพระจอมเกล้าพระนครเหนือ</small>
    </div>
    <button class="sidebar-toggle" aria-label="เปิดเมนู">&#9776;</button>
  </div>

  <div class="wrapper">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <nav>
        <div class="menu-title">โครงงาน</div>
        <a href="officer-dashboard.html">แดชบอร์ด</a>
        <a href="#" class="active">จัดการคำร้องโครงงาน</a>
      </nav>

      <div class="contact">
        <div class="gear-icons"><img src="../images/gear_red.png" alt="gear" /></div>
        <div>กรณีที่พบปัญหาการใช้งาน</div>
        <div>ติดต่อได้ที่ 02-555-2000</div>
        <div>กลุ่มงานทะเบียนฯ ต่อ 1628-1635</div>
        <div>บัณฑิตวิทยาลัย ต่อ 2406, 2413 - 2415</div>
        <div>กลุ่มงานการเงิน ต่อ 1602 - 1605</div>
        <div>งานกองทุน ต่อ 1150, 1161</div>
      </div>
    </aside>

    <!-- Main -->
    <main class="main2">
      <div class="req-container">
        <h1 class="req-title">จัดการคำร้อง</h1>

        <!-- Tabs -->
        <div class="req-tabs" role="tablist" aria-label="ชนิดคำร้อง">
          <button class="req-tab active" id="tabbtn-topic" data-tab="topic" role="tab" aria-selected="true" aria-controls="tab-topic">คำร้องยื่นสอบหัวข้อ</button>
          <button class="req-tab" id="tabbtn-project" data-tab="project" role="tab" aria-selected="false" aria-controls="tab-project">คำร้องยื่นสอบโปรเจคต์</button>
        </div>

        <!-- TAB: คำร้องยื่นสอบหัวข้อ -->
        <section id="tab-topic" class="req-card" role="tabpanel" aria-labelledby="tabbtn-topic">
          <div class="req-toolbar">
            <input id="topicSearch" class="req-search" type="search" placeholder="ค้นหากลุ่ม/หัวข้อ/อาจารย์…" />
            <div class="req-filters-2">
              <!-- script.js ใช้เฉพาะ topicStatus แต่อยู่คู่กับช่องนี้ให้สมบูรณ์ -->
              <select id="topicStatus" class="req-select">
                <option value="">ทั้งหมด (สถานะ)</option>
                <option value="รอตรวจ">รอตรวจ</option>
                <option value="แก้ไข">แก้ไข</option>
                <option value="อนุมัติ">อนุมัติ</option>
                <option value="ไม่ผ่าน">ไม่ผ่าน</option>
                <option value="รอสอบ">รอสอบ</option>
                <option value="กำลังทำ">กำลังทำ</option>
              </select>
              <select class="req-select" disabled>
                <option>—</option>
              </select>
            </div>
          </div>

          <div class="req-table-wrap">
            <!-- ต้องเป็น table#topicTable เพื่อให้ script เลือก #topicTable tbody tr ได้ -->
            <table class="req-table" id="topicTable">
              <thead>
                <tr>
                  <th>วันที่</th>
                  <th>กลุ่ม</th>
                  <th>หัวข้อ</th>
                  <th>ประเภท</th>
                  <th>อาจารย์ที่ปรึกษา</th>
                  <th data-col="status">สถานะ</th>
                  <th class="ta-right">การดำเนินการ</th>
                </tr>
              </thead>
              <tbody>
                <!-- ตัวอย่างแถว -->
                <tr
                  data-status="รอตรวจ"
                  data-type="โครงงานสหกิจ"
                  data-branch="IT"
                  data-date="2025-09-10"
                  data-team="PPWO"
                  data-title="Smart Hydroponic Monitor"
                  data-advisor="ผศ.ดร.บีสุดา ดาวเรือง"
                  data-coadvisor="ผศ.พีระศักดิ์ เสรีกุล"
                  data-objective="ตรวจสอบคุณภาพน้ำปลูกผักแบบเรียลไทม์ ลดต้นทุนและความผิดพลาด"
                  data-result="ต้นแบบ IoT + แดชบอร์ดใช้งานจริง"
                  data-scope="วัด pH/EC, ควบคุมปั๊ม, แจ้งเตือนผ่านมือถือ"
                  data-students1="6806022610097 นายปภังกร สุวรรณรัตน์"
                  data-students2="6806022610186 นายอคิราภ์ สมัครจิตร์"
                  data-students='["6806022610097 นายปภังกร สุวรรณรัตน์","6806022610186 นายอคิราภ์ สมัครจิตร์"]'
                  data-files='[{"name":"คำขอ.pdf","url":"#"},{"name":"สรุปโครงร่าง.docx","url":"#"}]'>
                  <td>2025-09-10</td>
                  <td>PPWO</td>
                  <td>Smart Hydroponic Monitor</td>
                  <td><span class="type-badge type-topic">โครงงานสหกิจ</span></td>
                  <td>ผศ.ดร.บีสุดา ดาวเรือง</td>
                  <td data-col="status"><span class="p p-wait">รอตรวจ</span></td>
                  <td class="row-actions ta-right">
                    <button class="btn-soft" data-action="detail">ดูรายละเอียด</button>
                    <button class="btn-schedule" data-action="schedule">กำหนดสอบ</button>
                  </td>
                </tr>

                <tr
                  data-status="แก้ไข"
                  data-type="โครงงานพิเศษ"
                  data-branch="INE"
                  data-date="2025-09-08"
                  data-team="Debuggers"
                  data-title="เว็บจัดการโครงงาน"
                  data-advisor="ผศ.ดร.นิติการ นาคเจือทอง"
                  data-coadvisor="ผศ.พีระศักดิ์ เสรีกุล"
                  data-objective="พัฒนาพอร์ทัลจัดการโครงงานครบวงจรสำหรับสาขา INE"
                  data-result="ระบบใช้งานได้จริง + ออกรายงาน"
                  data-scope="งานเวิร์กโฟลว์, ปฏิทินสอบ, สถิติ, อัปโหลดไฟล์"
                  data-students1="6806022610097 นายปภังกร สุวรรณรัตน์"
                  data-students2="6806022610186 นายอคิราภ์ สมัครจิตร์"
                  data-students='["6806022610097 นายปภังกร สุวรรณรัตน์","6806022610186 นายอคิราภ์ สมัครจิตร์"]'
                  data-files='[{"name":"คำขอ.pdf","url":"#"}]'>
                  <td>2025-09-08</td>
                  <td>Debuggers</td>
                  <td>เว็บจัดการโครงงาน</td>
                  <td><span class="type-badge type-project">โครงงานพิเศษ</span></td>
                  <td>ผศ.ดร.นิติการ นาคเจือทอง</td>
                  <td data-col="status"><span class="p p-edit">แก้ไข</span></td>
                  <td class="row-actions ta-right">
                    <button class="btn-soft" data-action="detail">ดูรายละเอียด</button>
                    <button class="btn-schedule" data-action="schedule">กำหนดสอบ</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- TAB: คำร้องยื่นสอบโปรเจคต์ -->
        <section id="tab-project" class="req-card" role="tabpanel" aria-labelledby="tabbtn-project" hidden>
          <div class="req-toolbar">
            <input id="projSearch" class="req-search" type="search" placeholder="ค้นหาโครงงาน/นักศึกษา…" />
            <div class="req-filters-2">
              <select id="projStatus" class="req-select">
                <option value="">สถานะทั้งหมด</option>
                <option value="รออนุมัติ">รออนุมัติ</option>
                <option value="อนุมัติ">อนุมัติ</option>
                <option value="ไม่ผ่าน">ไม่ผ่าน</option>
              </select>
              <select class="req-select" disabled>
                <option>—</option>
              </select>
            </div>
          </div>

          <div class="req-table-wrap">
            <!-- ต้องเป็น table#projTable เพื่อให้ script เลือก #projTable tbody tr ได้ -->
            <table class="req-table" id="projTable">
              <thead>
                <tr>
                  <th>วันที่</th>
                  <th>ทีม/นักศึกษา</th>
                  <th>หัวข้อโครงงาน</th>
                  <th>ประเภท</th>
                  <th>อาจารย์ที่ปรึกษา</th>
                  <th data-col="status">สถานะ</th>
                  <th class="ta-right">การดำเนินการ</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  data-status="รออนุมัติ"
                  data-type="โครงงานพิเศษ"
                  data-branch="INET"
                  data-date="2025-09-03"
                  data-team="Book_BBB"
                  data-title="ระบบเช่าหนังสือ"
                  data-advisor="รศ.ดร.อนิราช มิ่งขวัญ"
                  data-coadvisor="ผศ.ดร.พาฝัน ดวงไพศาล"
                  data-objective="สร้างระบบเช่าหนังสือแบบเรียลไทม์"
                  data-result="ต้นแบบพร้อมฐานข้อมูล"
                  data-scope="จัดการหนังสือ/สมาชิก/ยืม-คืน"
                  data-students='["6806022610097 นายปภังกร สุวรรณรัตน์","6806022610186 นายอคิราภ์ สมัครจิตร์"]'
                  data-files='[{"name":"requirements.pdf","url":"#"}]'>
                  <td>2025-09-03</td>
                  <td>Book_BBB</td>
                  <td>ระบบเช่าหนังสือ</td>
                  <td><span class="type-badge type-project">โครงงานพิเศษ</span></td>
                  <td>รศ.ดร.อนิราช มิ่งขวัญ</td>
                  <td data-col="status"><span class="pill pill-warn">รออนุมัติ</span></td>
                  <td class="ta-right">
                    <button class="btn-detail" data-action="detail">ดูรายละเอียด</button>
                    <button class="btn-schedule" data-action="schedule">กำหนดสอบ</button>
                  </td>
                </tr>

                <tr
                  data-status="รออนุมัติ"
                  data-type="โครงงานสหกิจ"
                  data-branch="INE"
                  data-date="2025-09-07"
                  data-team="CarTrade"
                  data-title="ระบบซื้อขายรถออนไลน์"
                  data-advisor="รศ.ดร.อนิราช มิ่งขวัญ"
                  data-coadvisor="ผศ.ดร.พาฝัน ดวงไพศาล"
                  data-objective="แพลตฟอร์มซื้อขายรถมือหนึ่ง/มือสอง"
                  data-result="เว็บแอปต้นแบบ"
                  data-scope="ผู้ใช้/ลงประกาศ/ค้นหา/แชท"
                  data-students='["6806022610097 นายปภังกร สุวรรณรัตน์","6806022610186 นายอคิราภ์ สมัครจิตร์"]'
                  data-files='[{"name":"design.docx","url":"#"}]'>
                  <td>2025-09-07</td>
                  <td>CarTrade</td>
                  <td>ระบบซื้อขายรถออนไลน์</td>
                  <td><span class="type-badge type-coop">โครงงานสหกิจ</span></td>
                  <td>รศ.ดร.อนิราช มิ่งขวัญ</td>
                  <td data-col="status"><span class="pill pill-warn">รออนุมัติ</span></td>
                  <td class="ta-right">
                    <button class="btn-detail" data-action="detail">ดูรายละเอียด</button>
                    <button class="btn-schedule" data-action="schedule">กำหนดสอบ</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>
      </div>
    </main>
  </div>

  <!-- Modal: รายละเอียด -->
  <div class="modal" id="reqDetail" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-header">
        <strong id="reqTitle">รายละเอียดคำร้อง</strong>
        <button class="modal-close" id="detailClose" aria-label="ปิด">×</button>
      </div>

      <div class="modal-body">
        <div class="detail-grid">
          <div>
            <span class="d-label">ชนิดคำร้อง</span>
            <div id="dType" class="d-value">-</div>
          </div>
          <div>
            <span class="d-label">วันที่ยื่น</span>
            <div id="dDate" class="d-value">-</div>
          </div>
          <div>
            <span class="d-label">กลุ่ม</span>
            <div id="dTeam" class="d-value">-</div>
          </div>
          <div>
            <span class="d-label">สาขาวิชา</span>
            <div id="dBranch" class="d-value">-</div>
          </div>

          <!-- รายชื่อนักศึกษา -->
          <div class="full detail-section">
            <span class="d-label">รายชื่อนักศึกษา</span>
            <p id="dStudents1" class="d-value">-</p><br>
            <p id="dStudents2" class="d-value">-</p>
          </div>

          <div>
            <span class="d-label">อาจารย์ที่ปรึกษา</span>
            <div id="dAdvisor" class="d-value">-</div>
          </div>
          <div>
            <span class="d-label">อาจารย์ที่ปรึกษาร่วม</span>
            <div id="dCoadvisor" class="d-value">-</div>
          </div>
          <div class="full">
            <span class="d-label">หัวข้อ/โปรเจคต์</span>
            <div id="dTopic" class="d-value">-</div>
          </div>

          <div class="full detail-section">
            <span class="d-label">วัตถุประสงค์</span>
            <p id="dObjective">-</p>
          </div>

          <div class="full detail-section">
            <span class="d-label">ขอบเขตโครงงาน</span>
            <p id="dScope">-</p>
          </div>

          <div class="full detail-files">
            <div class="d-label">ไฟล์เอกสารแนบ</div>
            <ul id="dFiles" class="file-list"></ul>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn-cancel" id="detailCancel">ปิด</button>
          <button class="btn-reject" id="btnReject">ไม่ผ่าน</button>
          <button class="btn-detail" id="btnApproveEdit">ผ่านแต่แก้ไข</button>
          <button class="btn-schedule" id="btnApprove">อนุมัติ</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: กำหนดสอบ (แยก modal คนละตัว) -->
  <div class="modal" id="scheduleModal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-header">
        <strong>กำหนดสอบ</strong>
        <button class="modal-close" id="scheduleClose" aria-label="ปิด">×</button>
      </div>

      <div class="modal-body">
        <div class="form-row">
          <label for="examDate">วันสอบ</label>
          <input type="date" id="examDate" class="input" />
        </div>
        <div class="form-row">
          <label for="examTime">เวลา</label>
          <input type="time" id="examTime" class="input" />
        </div>
        <div class="form-row">
          <label for="examRoom">ห้องสอบ</label>
          <input type="text" id="examRoom" class="input" placeholder="เช่น ห้อง 401" />
        </div>

        <div class="form-row-3">
          <div class="teacher-select">
            <label for="committee1Input">ประธาน</label>
            <!-- ล็อกไม่ให้พิมพ์หรือเลือก -->
            <input type="text" id="committee1Input" class="input" placeholder="กำหนดโดยระบบ" disabled aria-readonly="true" />
            <div id="committee1List" class="dropdown" hidden></div>
          </div>

          <div class="teacher-select">
            <label for="committee2Input">กรรมการสอบ 1</label>
            <input type="text" id="committee2Input" class="input" placeholder="พิมพ์ชื่ออาจารย์…" autocomplete="off" />
            <div id="committee2List" class="dropdown"></div>
          </div>

          <div class="teacher-select">
            <label for="committee3Input">กรรมการสอบ 2</label>
            <input type="text" id="committee3Input" class="input" placeholder="พิมพ์ชื่ออาจารย์…" autocomplete="off" />
            <div id="committee3List" class="dropdown"></div>
          </div>

          <div class="teacher-select">
            <label for="committee4Input">กรรมการสอบ 3</label>
            <input type="text" id="committee4Input" class="input" placeholder="พิมพ์ชื่ออาจารย์…" autocomplete="off" />
            <div id="committee4List" class="dropdown"></div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn-cancel" id="btnCancelSchedule">ยกเลิก</button>
        <button class="btn-save" id="btnSaveSchedule">บันทึก</button>
      </div>
    </div>
  </div>

  <footer>© 2025 ระบบจัดการโครงงาน · FITM · KMUTNB</footer>
</body>

</html>
